[**@base44/sdk v0.8.3**](../../README.mdx)

***

[@base44/sdk](./README.mdx) / [client](./client/README.mdx) / createClientFromRequest

# createClientFromRequest()

```ts
function createClientFromRequest(request): object;
```

Defined in: [client.ts:346](https://github.com/base44/sdk/blob/main/src/client.ts#L346)

Create a Base44 client from an HTTP request object

This utility function extracts authentication tokens and configuration from
standard HTTP headers, making it easy to initialize a client in server-side
environments like Next.js, Express, or other Node.js frameworks.

## Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `request` | `Request` | HTTP Request object with Base44 headers Expected headers: - `Authorization: Bearer <user-token>` - User authentication token - `Base44-Service-Authorization: Bearer <service-token>` - Service role token - `Base44-App-Id: <app-id>` - Application ID (required) - `Base44-Api-Url: <url>` - Custom API URL (optional, defaults to https://base44.app) - `Base44-Functions-Version: <version>` - Functions version (optional) |

## Returns

A configured Base44 client instance

### entities

```ts
entities: object;
```

### integrations

```ts
integrations: object;
```

### auth

```ts
auth: object;
```

#### auth.me()

```ts
me(): Promise<AxiosResponse<any, any>>;
```

Get current user information

Retrieves the authenticated user's profile data including
id, email, name, role, and other custom fields.

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to the current user data

##### Throws

If user is not authenticated

##### Example

```typescript
const user = await client.auth.me();
console.log(`Logged in as: ${user.name}`);
console.log(`Role: ${user.role}`);
```

#### auth.updateMe()

```ts
updateMe(data): Promise<AxiosResponse<any, any>>;
```

Update current user's profile data

Updates the authenticated user's information. You can update any
custom fields on the user entity.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `data` | `Record`\<`string`, `any`\> | Object containing fields to update |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to the updated user data

##### Throws

If user is not authenticated

##### Example

```typescript
const updatedUser = await client.auth.updateMe({
  name: 'John Doe',
  preferences: {
    theme: 'dark',
    notifications: true
  }
});
```

#### auth.redirectToLogin()

```ts
redirectToLogin(nextUrl): void;
```

Redirects the user to the app's login page

Navigates to the Base44 login page with a return URL. After successful
authentication, the user will be redirected back to the specified URL
with an access token in the query parameters.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `nextUrl` | `string` | URL to redirect to after successful login |

##### Returns

`void`

##### Throws

When not in a browser environment

##### Example

```typescript
// Redirect to login and return to current page
client.auth.redirectToLogin(window.location.href);

// Redirect to login and go to dashboard after
client.auth.redirectToLogin('/dashboard');
```

#### auth.logout()

```ts
logout(redirectUrl?): void;
```

Logout the current user

Removes the authentication token from memory and localStorage, then either
redirects to a specified URL or reloads the page to clear the session.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `redirectUrl?` | `string` | Optional URL to redirect to after logout. Reloads the page if not provided |

##### Returns

`void`

##### Example

```typescript
// Simple logout (reloads page)
client.auth.logout();

// Logout and redirect to login page
client.auth.logout('/login');

// Logout and redirect to home
client.auth.logout('/');
```

#### auth.setToken()

```ts
setToken(token, saveToStorage): void;
```

Set authentication token for the client

Updates the Authorization header for all API requests and optionally
saves the token to localStorage for persistence across page reloads.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `token` | `string` | Authentication token |
| `saveToStorage` | `boolean` | Whether to save the token to localStorage (default: true) |

##### Returns

`void`

##### Example

```typescript
// Set token and save to localStorage
client.auth.setToken('your-access-token');

// Set token without saving (for server-side or temporary tokens)
client.auth.setToken('your-access-token', false);
```

#### auth.loginViaEmailPassword()

```ts
loginViaEmailPassword(
   email, 
   password, 
   turnstileToken?): Promise<{
  access_token: string;
  user: any;
}>;
```

Login via email and password

Authenticates a user with their email and password credentials.
On success, automatically sets the token in the client and localStorage.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `email` | `string` | User's email address |
| `password` | `string` | User's password |
| `turnstileToken?` | `string` | Optional Cloudflare Turnstile captcha token for bot protection |

##### Returns

`Promise`\<\{
  `access_token`: `string`;
  `user`: `any`;
\}\>

Promise resolving to login response with access_token and user data

##### Throws

If credentials are invalid or authentication fails

##### Example

```typescript
try {
  const { access_token, user } = await client.auth.loginViaEmailPassword(
    'user@example.com',
    'password123'
  );
  console.log(`Logged in as ${user.name}`);
  // Token is automatically set in the client
} catch (error) {
  console.error('Login failed:', error.message);
}
```

#### auth.isAuthenticated()

```ts
isAuthenticated(): Promise<boolean>;
```

Verify if the current user is authenticated

Checks whether the current token is valid by attempting to fetch
the user's profile. Returns true if authenticated, false otherwise.

##### Returns

`Promise`\<`boolean`\>

Promise resolving to true if authenticated, false if not

##### Example

```typescript
if (await client.auth.isAuthenticated()) {
  console.log('User is logged in');
  const user = await client.auth.me();
} else {
  console.log('User needs to log in');
  client.auth.redirectToLogin('/dashboard');
}
```

#### auth.inviteUser()

```ts
inviteUser(userEmail, role): Promise<AxiosResponse<any, any>>;
```

Invite a user to the application

Sends an invitation email to the specified user with the assigned role.
The user will receive a link to complete their registration.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `userEmail` | `string` | Email address of the user to invite |
| `role` | `string` | Role to assign to the user (e.g., 'admin', 'editor', 'viewer') |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to the invitation result

##### Example

```typescript
await client.auth.inviteUser('newuser@example.com', 'editor');
console.log('Invitation sent!');
```

#### auth.register()

```ts
register(payload): Promise<AxiosResponse<any, any>>;
```

Register a new user account

Creates a new user account with email and password. May require
email verification via OTP depending on app configuration.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `payload` | \{ `email`: `string`; `password`: `string`; `turnstile_token?`: `string` \| `null`; `referral_code?`: `string` \| `null`; \} | Registration data |
| `payload.email` | `string` | User's email address |
| `payload.password` | `string` | User's password |
| `payload.turnstile_token?` | `string` \| `null` | Optional Cloudflare Turnstile captcha token |
| `payload.referral_code?` | `string` \| `null` | Optional referral code |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to the registration result

##### Example

```typescript
try {
  await client.auth.register({
    email: 'newuser@example.com',
    password: 'securePassword123'
  });
  // Check email for verification code
} catch (error) {
  console.error('Registration failed:', error.message);
}
```

#### auth.verifyOtp()

```ts
verifyOtp(params): Promise<AxiosResponse<any, any>>;
```

Verify email with OTP code

Verifies a user's email address using the one-time password (OTP)
sent to their email during registration.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | \{ `email`: `string`; `otpCode`: `string`; \} | Verification parameters |
| `params.email` | `string` | User's email address |
| `params.otpCode` | `string` | One-time password code from email |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to verification result with access token

##### Example

```typescript
const { access_token } = await client.auth.verifyOtp({
  email: 'user@example.com',
  otpCode: '123456'
});
client.auth.setToken(access_token);
```

#### auth.resendOtp()

```ts
resendOtp(email): Promise<AxiosResponse<any, any>>;
```

Resend OTP verification code

Sends a new OTP code to the user's email if the previous one expired
or was not received.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `email` | `string` | User's email address |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving when OTP is sent

##### Example

```typescript
await client.auth.resendOtp('user@example.com');
console.log('New verification code sent!');
```

#### auth.resetPasswordRequest()

```ts
resetPasswordRequest(email): Promise<AxiosResponse<any, any>>;
```

Request password reset

Initiates the password reset process by sending a reset link
to the user's email address.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `email` | `string` | User's email address |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving when reset email is sent

##### Example

```typescript
await client.auth.resetPasswordRequest('user@example.com');
console.log('Password reset email sent!');
```

#### auth.resetPassword()

```ts
resetPassword(params): Promise<AxiosResponse<any, any>>;
```

Reset password with token

Completes the password reset process using the reset token from
the email and setting a new password.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | \{ `resetToken`: `string`; `newPassword`: `string`; \} | Reset parameters |
| `params.resetToken` | `string` | Reset token from email link |
| `params.newPassword` | `string` | New password to set |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving when password is reset

##### Example

```typescript
// Extract token from email link
const urlParams = new URLSearchParams(window.location.search);
const resetToken = urlParams.get('reset_token');

await client.auth.resetPassword({
  resetToken,
  newPassword: 'newSecurePassword123'
});
console.log('Password reset successful!');
```

#### auth.changePassword()

```ts
changePassword(params): Promise<AxiosResponse<any, any>>;
```

Change password for authenticated user

Allows a logged-in user to change their password by providing
their current password and a new password.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | \{ `userId`: `string`; `currentPassword`: `string`; `newPassword`: `string`; \} | Change password parameters |
| `params.userId` | `string` | User's ID |
| `params.currentPassword` | `string` | Current password for verification |
| `params.newPassword` | `string` | New password to set |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving when password is changed

##### Throws

If current password is incorrect

##### Example

```typescript
const user = await client.auth.me();

try {
  await client.auth.changePassword({
    userId: user.id,
    currentPassword: 'oldPassword123',
    newPassword: 'newSecurePassword456'
  });
  console.log('Password changed successfully!');
} catch (error) {
  console.error('Failed to change password:', error.message);
}
```

### functions

```ts
functions: object;
```

#### functions.invoke()

```ts
invoke(functionName, data): Promise<AxiosResponse<any, any>>;
```

Invoke a custom function by name

Executes a cloud function defined in your Base44 application with the provided
parameters. Automatically handles file uploads when File objects are included.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `functionName` | `string` | Name of the function to invoke |
| `data` | `Record`\<`string`, `any`\> | Object containing named parameters for the function |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to the function's response

##### Throws

If function doesn't exist or execution fails

##### Example

```typescript
// Simple function call
const result = await client.functions.invoke('calculateTotal', {
  items: ['item1', 'item2'],
  discount: 0.1
});

// Function with file upload
const fileInput = document.querySelector('input[type="file"]');
const result = await client.functions.invoke('processImage', {
  image: fileInput.files[0],
  filter: 'grayscale'
});

// Service role function invocation
const adminResult = await client.asServiceRole.functions.invoke('adminTask', {
  action: 'cleanup'
});
```

### agents

```ts
agents: object;
```

#### agents.getConversations()

```ts
getConversations: () => Promise<AgentConversation[]>;
```

Get all agent conversations

##### Returns

`Promise`\<[`AgentConversation`](./index/type-aliases/AgentConversation.mdx)[]\>

Promise resolving to array of conversations

##### Example

```typescript
const conversations = await client.agents.getConversations();
console.log(`Total conversations: ${conversations.length}`);
```

#### agents.getConversation()

```ts
getConversation: (conversationId) => Promise<
  | AgentConversation
| undefined>;
```

Get a specific agent conversation by ID

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversationId` | `string` | The ID of the conversation to retrieve |

##### Returns

`Promise`\<
  \| [`AgentConversation`](./index/type-aliases/AgentConversation.mdx)
  \| `undefined`\>

Promise resolving to the conversation or undefined

##### Example

```typescript
const conversation = await client.agents.getConversation('conv-123');
console.log(conversation.messages);
```

#### agents.listConversations()

```ts
listConversations: (filterParams) => Promise<AgentConversation[]>;
```

List agent conversations with filtering and pagination

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `filterParams` | [`ModelFilterParams`](./index/type-aliases/ModelFilterParams.mdx) | Query parameters for filtering |

##### Returns

`Promise`\<[`AgentConversation`](./index/type-aliases/AgentConversation.mdx)[]\>

Promise resolving to filtered conversations

##### Example

```typescript
const recent = await client.agents.listConversations({
  sort: '-created_at',
  limit: 10
});
```

#### agents.createConversation()

```ts
createConversation: (conversation) => Promise<AgentConversation>;
```

Create a new agent conversation

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversation` | \{ `agent_name`: `string`; `metadata?`: `Record`\<`string`, `any`\>; \} | Conversation data |
| `conversation.agent_name` | `string` | Name of the agent to create conversation with |
| `conversation.metadata?` | `Record`\<`string`, `any`\> | Optional metadata for the conversation |

##### Returns

`Promise`\<[`AgentConversation`](./index/type-aliases/AgentConversation.mdx)\>

Promise resolving to the created conversation

##### Example

```typescript
const conversation = await client.agents.createConversation({
  agent_name: 'support-agent',
  metadata: { user_id: 'user-123' }
});
```

#### agents.addMessage()

```ts
addMessage: (conversation, message) => Promise<AgentMessage>;
```

Add a message to an agent conversation

Sends a message and updates the conversation in real-time via WebSocket.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversation` | [`AgentConversation`](./index/type-aliases/AgentConversation.mdx) | The conversation to add the message to |
| `message` | [`AgentMessage`](./index/type-aliases/AgentMessage.mdx) | The message to add |

##### Returns

`Promise`\<[`AgentMessage`](./index/type-aliases/AgentMessage.mdx)\>

Promise resolving to the created message

##### Example

```typescript
const message = await client.agents.addMessage(conversation, {
  role: 'user',
  content: 'Hello, I need help with my order'
});
```

#### agents.subscribeToConversation()

```ts
subscribeToConversation: (conversationId, onUpdate?) => () => void;
```

Subscribe to real-time updates for a conversation

Establishes a WebSocket connection to receive live updates when
the agent responds or the conversation is updated.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversationId` | `string` | The ID of the conversation to subscribe to |
| `onUpdate?` | (`conversation`) => `void` | Callback function invoked when the conversation updates |

##### Returns

Unsubscribe function to stop receiving updates

```ts
(): void;
```

###### Returns

`void`

##### Example

```typescript
const unsubscribe = client.agents.subscribeToConversation(
  'conv-123',
  (updatedConversation) => {
    console.log('New message:', updatedConversation.messages);
  }
);

// Later, stop listening
unsubscribe();
```

#### agents.getWhatsAppConnectURL()

```ts
getWhatsAppConnectURL: (agentName) => string;
```

Get WhatsApp connection URL for an agent

Generates a URL that allows users to connect with an agent via WhatsApp.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `agentName` | `string` | Name of the agent |

##### Returns

`string`

WhatsApp connection URL with authentication token

##### Example

```typescript
const whatsappURL = client.agents.getWhatsAppConnectURL('support-agent');
window.open(whatsappURL, '_blank');
```

### appLogs

```ts
appLogs: object;
```

#### appLogs.logUserInApp()

```ts
logUserInApp(pageName): Promise<void>;
```

Log user activity in the app

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `pageName` | `string` | Name of the page being visited |

##### Returns

`Promise`\<`void`\>

#### appLogs.fetchLogs()

```ts
fetchLogs(params): Promise<any>;
```

Fetch app logs with optional parameters

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | `Record`\<`string`, `any`\> | Query parameters for filtering logs |

##### Returns

`Promise`\<`any`\>

App logs data

#### appLogs.getStats()

```ts
getStats(params): Promise<any>;
```

Get app statistics

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | `Record`\<`string`, `any`\> | Query parameters for filtering stats |

##### Returns

`Promise`\<`any`\>

App statistics

### cleanup()

```ts
cleanup: () => void;
```

#### Returns

`void`

### setToken()

```ts
setToken(newToken): void;
```

Set authentication token for all requests

Updates the authentication token used by all modules and the websocket connection.
Also saves the token to localStorage if in a browser environment.

#### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `newToken` | `string` | The new authentication token |

#### Returns

`void`

#### Example

```typescript
const client = createClient({ appId: 'your-app-id' });

// After user logs in
const { access_token } = await client.auth.loginViaEmailPassword(email, password);
client.setToken(access_token);
```

### getConfig()

```ts
getConfig(): object;
```

Get current client configuration

#### Returns

`object`

An object containing the current serverUrl, appId, and requiresAuth settings

##### serverUrl

```ts
serverUrl: string;
```

##### appId

```ts
appId: string;
```

##### requiresAuth

```ts
requiresAuth: boolean;
```

#### Example

```typescript
const config = client.getConfig();
console.log(`Connected to: ${config.serverUrl}`);
console.log(`App ID: ${config.appId}`);
```

### asServiceRole

```ts
asServiceRole: object;
```

#### asServiceRole.entities

```ts
entities: object;
```

#### asServiceRole.integrations

```ts
integrations: object;
```

#### asServiceRole.sso

```ts
sso: object;
```

#### asServiceRole.sso.getAccessToken()

```ts
getAccessToken(userid): Promise<AxiosResponse<any, any>>;
```

Get current user sso access token

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `userid` | `string` | User ID to include as path parameter |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Current user sso access_token

#### asServiceRole.functions

```ts
functions: object;
```

#### asServiceRole.functions.invoke()

```ts
invoke(functionName, data): Promise<AxiosResponse<any, any>>;
```

Invoke a custom function by name

Executes a cloud function defined in your Base44 application with the provided
parameters. Automatically handles file uploads when File objects are included.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `functionName` | `string` | Name of the function to invoke |
| `data` | `Record`\<`string`, `any`\> | Object containing named parameters for the function |

##### Returns

`Promise`\<`AxiosResponse`\<`any`, `any`\>\>

Promise resolving to the function's response

##### Throws

If function doesn't exist or execution fails

##### Example

```typescript
// Simple function call
const result = await client.functions.invoke('calculateTotal', {
  items: ['item1', 'item2'],
  discount: 0.1
});

// Function with file upload
const fileInput = document.querySelector('input[type="file"]');
const result = await client.functions.invoke('processImage', {
  image: fileInput.files[0],
  filter: 'grayscale'
});

// Service role function invocation
const adminResult = await client.asServiceRole.functions.invoke('adminTask', {
  action: 'cleanup'
});
```

#### asServiceRole.agents

```ts
agents: object;
```

#### asServiceRole.agents.getConversations()

```ts
getConversations: () => Promise<AgentConversation[]>;
```

Get all agent conversations

##### Returns

`Promise`\<[`AgentConversation`](./index/type-aliases/AgentConversation.mdx)[]\>

Promise resolving to array of conversations

##### Example

```typescript
const conversations = await client.agents.getConversations();
console.log(`Total conversations: ${conversations.length}`);
```

#### asServiceRole.agents.getConversation()

```ts
getConversation: (conversationId) => Promise<
  | AgentConversation
| undefined>;
```

Get a specific agent conversation by ID

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversationId` | `string` | The ID of the conversation to retrieve |

##### Returns

`Promise`\<
  \| [`AgentConversation`](./index/type-aliases/AgentConversation.mdx)
  \| `undefined`\>

Promise resolving to the conversation or undefined

##### Example

```typescript
const conversation = await client.agents.getConversation('conv-123');
console.log(conversation.messages);
```

#### asServiceRole.agents.listConversations()

```ts
listConversations: (filterParams) => Promise<AgentConversation[]>;
```

List agent conversations with filtering and pagination

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `filterParams` | [`ModelFilterParams`](./index/type-aliases/ModelFilterParams.mdx) | Query parameters for filtering |

##### Returns

`Promise`\<[`AgentConversation`](./index/type-aliases/AgentConversation.mdx)[]\>

Promise resolving to filtered conversations

##### Example

```typescript
const recent = await client.agents.listConversations({
  sort: '-created_at',
  limit: 10
});
```

#### asServiceRole.agents.createConversation()

```ts
createConversation: (conversation) => Promise<AgentConversation>;
```

Create a new agent conversation

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversation` | \{ `agent_name`: `string`; `metadata?`: `Record`\<`string`, `any`\>; \} | Conversation data |
| `conversation.agent_name` | `string` | Name of the agent to create conversation with |
| `conversation.metadata?` | `Record`\<`string`, `any`\> | Optional metadata for the conversation |

##### Returns

`Promise`\<[`AgentConversation`](./index/type-aliases/AgentConversation.mdx)\>

Promise resolving to the created conversation

##### Example

```typescript
const conversation = await client.agents.createConversation({
  agent_name: 'support-agent',
  metadata: { user_id: 'user-123' }
});
```

#### asServiceRole.agents.addMessage()

```ts
addMessage: (conversation, message) => Promise<AgentMessage>;
```

Add a message to an agent conversation

Sends a message and updates the conversation in real-time via WebSocket.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversation` | [`AgentConversation`](./index/type-aliases/AgentConversation.mdx) | The conversation to add the message to |
| `message` | [`AgentMessage`](./index/type-aliases/AgentMessage.mdx) | The message to add |

##### Returns

`Promise`\<[`AgentMessage`](./index/type-aliases/AgentMessage.mdx)\>

Promise resolving to the created message

##### Example

```typescript
const message = await client.agents.addMessage(conversation, {
  role: 'user',
  content: 'Hello, I need help with my order'
});
```

#### asServiceRole.agents.subscribeToConversation()

```ts
subscribeToConversation: (conversationId, onUpdate?) => () => void;
```

Subscribe to real-time updates for a conversation

Establishes a WebSocket connection to receive live updates when
the agent responds or the conversation is updated.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `conversationId` | `string` | The ID of the conversation to subscribe to |
| `onUpdate?` | (`conversation`) => `void` | Callback function invoked when the conversation updates |

##### Returns

Unsubscribe function to stop receiving updates

```ts
(): void;
```

###### Returns

`void`

##### Example

```typescript
const unsubscribe = client.agents.subscribeToConversation(
  'conv-123',
  (updatedConversation) => {
    console.log('New message:', updatedConversation.messages);
  }
);

// Later, stop listening
unsubscribe();
```

#### asServiceRole.agents.getWhatsAppConnectURL()

```ts
getWhatsAppConnectURL: (agentName) => string;
```

Get WhatsApp connection URL for an agent

Generates a URL that allows users to connect with an agent via WhatsApp.

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `agentName` | `string` | Name of the agent |

##### Returns

`string`

WhatsApp connection URL with authentication token

##### Example

```typescript
const whatsappURL = client.agents.getWhatsAppConnectURL('support-agent');
window.open(whatsappURL, '_blank');
```

#### asServiceRole.appLogs

```ts
appLogs: object;
```

#### asServiceRole.appLogs.logUserInApp()

```ts
logUserInApp(pageName): Promise<void>;
```

Log user activity in the app

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `pageName` | `string` | Name of the page being visited |

##### Returns

`Promise`\<`void`\>

#### asServiceRole.appLogs.fetchLogs()

```ts
fetchLogs(params): Promise<any>;
```

Fetch app logs with optional parameters

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | `Record`\<`string`, `any`\> | Query parameters for filtering logs |

##### Returns

`Promise`\<`any`\>

App logs data

#### asServiceRole.appLogs.getStats()

```ts
getStats(params): Promise<any>;
```

Get app statistics

##### Parameters

| Parameter | Type | Description |
| ------ | ------ | ------ |
| `params` | `Record`\<`string`, `any`\> | Query parameters for filtering stats |

##### Returns

`Promise`\<`any`\>

App statistics

#### asServiceRole.cleanup()

```ts
cleanup: () => void;
```

##### Returns

`void`

## Throws

If Base44-App-Id header is missing or authorization headers are malformed

## Example

```typescript
// In a Next.js API route
export async function GET(request: Request) {
  const client = createClientFromRequest(request);
  const data = await client.entities.Product.list();
  return Response.json(data);
}

// In an Express handler
app.get('/api/data', async (req, res) => {
  const client = createClientFromRequest(req);
  const data = await client.entities.User.list();
  res.json(data);
});
```
